## https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/

## Script Functionality
## Restore the registry key that was removed in order to apply the workaround to CVE-2022-30190 as described above.

## Usage
## Script may be loaded via InTune for MDM. 
## Execute the script from an elevated PowerShell window locally.

## Legal
## Sentrium will not be held liable should any damage be caused by the use of this script.


# Change the filepath of the registry key here if needed
$regfile = 'C:\backup\msdt.reg'

try{
    # Check if the registry key file exists before attempting import
    if (Test-Path -Path $regfile -PathType Leaf){
        "File exists, importing"
        reg import $regfile
    }
    # File was not found, check the reg key export exists and the path is correctly set above.
    else{
        "The registry key was not found, please check the location of the file."            
    }    

}
catch{
    Write-Host "An error occurred:"
    Write-Host $_
}